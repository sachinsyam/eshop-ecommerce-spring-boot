<!doctype html>

<html xmlns:th="http://www.thymeleaf.org">
<head>
  <!--    <link th:href="@{/assets/css/style.css}" rel="stylesheet">-->
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Reset Password</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
        crossorigin="anonymous">


</head>
<style>
        .login-form {
                width: 340px;
                margin: 100px auto;
                  font-size: 15px;
            }
            .login-form form {
                margin-bottom: 15px;
                background: #f7f7f7;
                box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
                padding: 30px;
            }
            .login-form h2 {
                margin: 0 0 15px;
            }
</style>
<body class="">


<div class="login-form">
  <form th:action="@{/resetPassword}" method="post" class="login-background" id="resetForm">
    <h2 class="text-center">Reset Password</h2>

    <div class="row">
      <div class="col">

        <div th:if="${error}" class="alert alert-danger" role="alert">
          User does not exist.
        </div>

        <input required class="form-control" type="email" id="email" name="email" placeholder="Email">
      </div>
    </div>
    <div class="row">
      <div class="col text-center">
        <button id="resetBtn" onclick="validateEmail()" type="submit" class="form-control btn btn-primary mt-3">Reset Password</button>
        <button hidden="hidden" id="btnSpinner" class="btn btn-primary mt-3" type="button" disabled>
          <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
          Reset Password
        </button>
      </div>

    </div>
  </form>
</div>

<script>
  function validateEmail() {
    var emailInput = document.getElementById("email");
    var btn = document.getElementById("resetBtn");
    var btnSpinner = document.getElementById("btnSpinner");

    // Email validation using regex
    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    var isValidEmail = emailRegex.test(emailInput.value);

    if (isValidEmail) {
      btn.hidden = true;
      btnSpinner.hidden = false;
    }
  }

  document.getElementById("resetForm").addEventListener("submit", function(event) {

    validateEmail(); // Call validateEmail function to check email and show the spinner
  });
</script>

</body>
</html>
